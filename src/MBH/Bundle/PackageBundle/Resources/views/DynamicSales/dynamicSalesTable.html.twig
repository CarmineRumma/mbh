{% if error is defined and error is not empty and error %}
    <div class="alert alert-warning"><i class="fa fa-exclamation-circle"> </i> {{ error }}</div>
{% else %}
    {% if dynamicSales|length > 0 %}
        {% set commonDynamicSalesData = dynamicSales[0] %}
        {% set maxCount = 0 %}
        {% set periodsCount = commonDynamicSalesData.periods|length %}
        {% for dynamicSalePeriodCount in commonDynamicSalesData.periods %}
            {% if maxCount < dynamicSalePeriodCount|length %}
                {% set maxCount = dynamicSalePeriodCount|length %}
            {% endif %}
        {% endfor %}

        <table id="headerTable" class="table table-bordered table-striped table-condensed mbh-grid text-center">
            <tbody>
            <tr class="dates">
                <td class="first-th line-name" rowspan="{{ periodsCount }}"></td>
                <td class="first-th periods-cell" rowspan="{{ periodsCount }}">
                    <small>{{ 'dynamic.sales.day.periods'|trans({},'MBHPackageBundle') }}</small>
                </td>
                {% for dynamicSalePeriod in commonDynamicSalesData.periods %}
                {% set index = loop.index %}
                {% if loop.index != 1 %}
            <tr class="dates">
                {% endif %}
                {% for dynamicSaleDay  in dynamicSalePeriod %}
                    {% if not loop.last %}
                        <td class="date-td table-cell text-center {% if dynamicSaleDay.dateSales|date('N') >= 6 %} text-danger{% endif %}">
                            {{ dynamicSaleDay.dateSales|date('d.m') }}
                            <div class="text-muted text-center {% if dynamicSaleDay.dateSales|date('N') >= 6 %} text-danger{% endif %}">
                                {{ weekdays[dynamicSaleDay.dateSales|date('N')]|lower }}
                            </div>
                        </td>
                    {% endif %}
                {% endfor %}
                {% if (maxCount - commonDynamicSalesData.periods[index-1]|length) > 0 %}
                    {% for i in 1..(maxCount - commonDynamicSalesData.periods[index-1]|length) %}
                        <td class="date-td">-</td>
                    {% endfor %}
                {% endif %}
                {% if loop.index == 1 %}
                    <td class="first-th table-cell date-td" rowspan="{{ periodsCount }}">
                        <small>{{ 'dynamic.sales.day.summary'|trans({},'MBHPackageBundle') }}</small>
                    </td>
                {% endif %}
            </tr>
            {% endfor %}
            </tbody>
        </table>

        {% for dynamicSaleTypeData in dynamicSales %}
            <table class="table table-bordered table-condensed rightTable">
                <tbody>
                {% for shownOption in optionsShows %}
                    <tr>
                    <td class="first-th line-name" rowspan="{{ periodsCount }}">
                        <small>{{ ('dynamic.sales.day.' ~ shownOption)|trans({},'MBHPackageBundle') }}</small>
                    </td>
                    {% for dynamicSalePeriod in dynamicSaleTypeData.periods %}
                        {% if  loop.index != 1 %}
                            <tr>
                        {% endif %}
                        <td class="periods-cell" data-class="{{ shownOption }}">
                            {{ dynamicSalePeriod|first.dateSales|date('d.m.Y') }}
                            - {{ dynamicSalePeriod|last.dateSales|date('d.m.Y') }}
                        </td>
                        </tr>
                    {% endfor %}
                {% endfor %}
                {% if dynamicSaleTypeData.comparison is not null and (optionsShows|length > 0) %}
                    <table class="table table-bordered table-condensed rightTable rightTable-comparison">
                        <tbody>
                        {% for shownOption in optionsShows %}
                            <tr data-class="{{ shownOption ~ '-compare' }}">
                                <td class="first-th line-name text-center" rowspan="2">
                                    <small>{{ ('dynamic.sales.day.' ~ shownOption)|trans({},'MBHPackageBundle') }}</small>
                                </td>
                                <td class="periods-cell text-center" data-class="{{ shownOption ~ '-compare' }}">
                                    <small>{{ 'dynamic.sales.day.sales.summ'|trans({},'MBHPackageBundle') }}</small>
                                </td>
                            </tr>
                            <tr data-class="{{ shownOption ~ '-compare-percentage' }}">
                                <td class="periods-cell">
                                    %
                                </td>
                            </tr>
                        {% endfor %}
                        </tbody>
                    </table>
                {% endif %}
                </tbody>
            </table>
        {% endfor %}

        {% for dynamicSaleTypeData in dynamicSales %}
            <table id="{{ dynamicSaleTypeData.roomType ? dynamicSaleTypeData.roomType.id : 'summary' }}"
                   class="dynamic-sales-table table table-bordered not-auto-datatable table-striped table-hover table-condensed mbh-grid text-center">
                <tbody>
                <tr class="mbh-grid-header2 warning">
                    <td colspan="{{ maxCount +2 }}" style="text-align: left">
                        <strong class="table-title">
                            {% if (dynamicSaleTypeData.roomType is null ) %}
                                {{ 'dynamic.sales.result'|trans({},'MBHPackageBundle') }}
                            {% else %}
                                {{ dynamicSaleTypeData.roomType.title }}
                            {% endif %}
                        </strong>&nbsp;&nbsp;
                    </td>
                </tr>
                {% for shownOption in optionsShows %}
                <tr data-class="{{ shownOption }}">
                    <td class="left-offset-line"></td>
                    {% for dynamicSalePeriod in dynamicSaleTypeData.periods %}
                        {% set index = loop.index %}
                        {% if  loop.index != 1 %}
                            <tr data-class="{{ shownOption }}">
                            <td class="left-offset-line"></td>
                        {% endif %}

                        {% for saleDatyIndex, dynamicSaleDay in dynamicSalePeriod %}
                            {% set isSummary = (saleDatyIndex == 'summ') %}
                            {% if loop.last %}
                                {% if (maxCount - dynamicSaleTypeData.periods[index - 1]|length) > 0 %}
                                    {% for i in 1..(maxCount - dynamicSaleTypeData.periods[index - 1]|length) %}
                                        <td>-</td>
                                    {% endfor %}
                                {% endif %}
                                <td class="text-right table-cell" style="text-align: right">
                                    <strong>{{ dynamicSaleDay.getSpecifiedValue(shownOption, isSummary) }}</strong>
                                </td>
                            {% else %}
                                <td class="table-cell">
                                    {{ dynamicSaleDay.getSpecifiedValue(shownOption, isSummary) }}
                                </td>
                            {% endif %}
                        {% endfor %}
                        </tr>
                    {% endfor %}
                {% endfor %}
                {% if dynamicSaleTypeData.comparison is not null and optionsShows|length > 0 %}
                    <tr class="info">
                        <td class="comparison-cell text-left" rowspan="{{ periodsCount - 1 }}" colspan="{{ maxCount + 2 }}">
                            <strong class="table-title">{{ 'dynamic.sales.day.sales.comparison'|trans({},'MBHPackageBundle') }} </strong>
                        </td>
                    </tr>
                    {% for shownOption in optionsShows %}
                        {% for comparisonPeriodData in dynamicSaleTypeData.comparison %}
                            {% set index = loop.index %}
                            <tr class="success" data-class="{{ shownOption ~ '-compare' }}">
                                <td class="left-offset-line"></td>
                                {% for comparisonDay in comparisonPeriodData %}
                                    <td>
                                        {% if loop.index < dynamicSaleTypeData.periods[index]|length and index > 0 %}
                                            {{ comparisonDay.getComparisonData(shownOption) }}
                                        {% else %}
                                            -
                                        {% endif %}
                                    </td>
                                {% endfor %}
                            </tr>
                            <tr class="warning" data-class="{{ shownOption ~ '-compare-percentage' }}">
                                <td class="left-offset-line"></td>
                                {% for comparisonDay in comparisonPeriodData %}
                                    <td>
                                        {% if loop.index < dynamicSaleTypeData.periods[index]|length and index > 0 %}
                                            {{ comparisonDay.getComparisonData(shownOption, true) }}%
                                        {% else %}
                                            -
                                        {% endif %}
                                    </td>
                                {% endfor %}
                            </tr>
                        {% endfor %}
                    {% endfor %}
                {% endif %}
                </tbody>
            </table>
        {% endfor %}
    {% endif %}
{% endif %}