<h2>Карта</h2>

<div id="map"></div>

<script src="http://zamkadom24.sites.maxibooking.ru/assets/js/jquery-1.11.3.min.js"></script>
<script>
    var map;
    var marker;

    function initMap() {
        var position;
        {% if hotels %}
            position = new google.maps.LatLng({{ (hotels|first).latitude }}, {{ (hotels|first).longitude }});
        {% endif %}
        map = new google.maps.Map(document.getElementById('map'), {
            center: position,
            zoom: 8
        })
        {% for hotel in hotels %}
            position = {lat: {{ hotel.latitude }}, lng: {{ hotel.longitude }}};
            marker{{ hotel.id }} = new google.maps.Marker({
                position: position,
                map: map,
                title: '{{ hotel.fullTitle }}'
            });
            var infowindow{{ hotel.id }} = new google.maps.InfoWindow({
                content: '<a href="{{ path('simple_search_view', {id: hotel.id}) }}">{{ hotel.fullTitle }}</a>'
            });
            marker{{ hotel.id }}.addListener('click', function() {
                infowindow{{ hotel.id }}.open(map, marker{{ hotel.id }});
            });
        {% endfor %}

        {% for key, sight in sights %}
        position = {lat: {{ sight.lat }}, lng: {{ sight.lon }}};
        marker{{ key }} = new google.maps.Marker({
            position: position,
            map: map,
            title: '{{ sight.name }}'
        });
        var infowindow{{ key }} = new google.maps.InfoWindow({
            content: '<strong>{{ sight.name }}</strong> {{ sight.desc }}'
        });
        marker{{ key }}.addListener('click', function() {
            infowindow{{ key }}.open(map, marker{{ key }});
        });
        {% endfor %}
    }
</script>
<style>
    #map {
        width: 100%;
        height: 350px;
    }
</style>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCfKBAVL-KTZM53CNZsmx-xsusJe21fkfE&callback=initMap"></script>